

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>3. What can be learned? &#8212; KI üben, Klavier trainieren</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/03_what-to-learn';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4. Measuring" href="04_measuring.html" />
    <link rel="prev" title="2. The artificial" href="02_artificial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
  
    <p class="title logo__title">KI üben, Klavier trainieren</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    KI üben, Klavier trainieren
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction &amp; Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_training.html">1. Training and Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_artificial.html">2. The artificial</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. What can be learned?</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_measuring.html">4. Measuring</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_markov.html">5. The likelihood of the successive note</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_player_limitations.html">6. Player limitations</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_representation.html">7. Representation of sonic data</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_ann.html">8. Artificial Neural networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_rnn.html">9. Recursive learning of patterns via RNN</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../player_piano_evening.html">Player Piano Evening</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/03_what-to-learn.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>What can be learned?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-data">3.1. Analyzing data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-derive-from-data-analysis">3.2. What to derive from data analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcculloch-and-pitts-model">3.3. McCulloch and Pitts model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perceptron">3.3.1. Perceptron</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="what-can-be-learned">
<h1><span class="section-number">3. </span>What can be learned?<a class="headerlink" href="#what-can-be-learned" title="Permalink to this heading">#</a></h1>
<p>The metaphysical question of what can be learned is not typically considered in our daily lives, as we often focus on the more practical question of how something can be learned.
However, when transferring human learning achievements, understanding, and comprehension to a machine, we must consider not only how a machine could learn this information but also whether it is possible for the machine to learn it at all.</p>
<p>As cultural beings, our perception of any circumstance is inevitably influenced by its implicit cultural framework.
Frameworks such as critical theory aim to uncover how these implicit structures shape our understanding. For example, when discussing transportation, we already have subjective associations and relations with the topic.</p>
<p>This concept also applies to music, as illustrated by the different perceptions of tuning systems in different cultures.
To approximate such sensory sensitivity in a machine learning model, we need to use mathematical formalism.
The basic idea of machine learning is that this sensitivity and information is embedded in data, and its underlying and inherent patterns can be detected and extracted.</p>
<p>A machine learning algorithm is essentially a mathematical function with numerous variables that maps an input to an output, a result.
One might assume that it is always necessary to provide pairs of inputs and outputs to identify a structure.
However, it is often sufficient to present enough data for the algorithm to discern patterns.</p>
<p>This can be demonstrated by comparing images of hand-drawn digits, such as the numbers 3 and 8, from the <a class="reference external" href="https://en.wikipedia.org/wiki/MNIST_database">MNIST dataset</a>.</p>
<figure class="align-default" id="id2">
<img alt="../_images/mnist_3.png" src="../_images/mnist_3.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.1 </span><span class="caption-text">Some examples of a handwritten <span class="math notranslate nohighlight">\(3\)</span> of the <a class="reference external" href="https://en.wikipedia.org/wiki/MNIST_database">MNIST dataset</a>.</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<img alt="../_images/mnist_8.png" src="../_images/mnist_8.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Some examples of a handwritten <span class="math notranslate nohighlight">\(8\)</span> of the <a class="reference external" href="https://en.wikipedia.org/wiki/MNIST_database">MNIST dataset</a>.</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Within this document, we want to take a look how to analyze data and question how different mathematical functions implement capabilities to <em>learn</em> tasks of different <em>complexity</em>.</p>
<section id="analyzing-data">
<h2><span class="section-number">3.1. </span>Analyzing data<a class="headerlink" href="#analyzing-data" title="Permalink to this heading">#</a></h2>
<p>We want to take a first look on how to analyze data from within Python by making use of tools such as <em>numpy</em> (for mathematical operations), <em>pandas</em> (for data aggregation and managing) and <em>matplotlib</em> (for plotting data).
The dataset we will take a small look at will be the already mentioned MNIST dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">torchvision.datasets</span> <span class="kn">import</span> <span class="n">MNIST</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;svg&#39;

<span class="c1"># load the MNIST dataset</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;mnist&quot;</span><span class="p">),</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># convert data to a numpy array</span>
<span class="n">mnist_data</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="c1"># get the indices of the dataset series which are showing 3 / 8</span>
<span class="n">idx_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">idx_8</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">targets</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Number of samples for each class&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">([</span><span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;8&quot;</span><span class="p">],</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_8</span><span class="p">[</span><span class="mi">0</span><span class="p">])]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6438f1a5dd771a012b9ddb3b76adc4047ee6e661413865ab51042da504ac43e8.svg" src="../_images/6438f1a5dd771a012b9ddb3b76adc4047ee6e661413865ab51042da504ac43e8.svg" /></div>
</div>
<p>Already with this, we can take a look the different kind of variety these two numbers have.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_1</span><span class="p">,</span> <span class="n">ax_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Meaned 3 and 8&quot;</span><span class="p">)</span>

<span class="n">ax_1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_8</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4edc5da062ab3fdde91bca07ccb6948897c310ada53975568b841603dcc7f9ca.svg" src="../_images/4edc5da062ab3fdde91bca07ccb6948897c310ada53975568b841603dcc7f9ca.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_1</span><span class="p">,</span> <span class="n">ax_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Maxed 3 and 8&quot;</span><span class="p">)</span>

<span class="n">ax_1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_3</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_8</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b8cf16527d5a592ca1a1c7ce44e2d0c93920424952090c020c6d0cd84117d1d3.svg" src="../_images/b8cf16527d5a592ca1a1c7ce44e2d0c93920424952090c020c6d0cd84117d1d3.svg" /></div>
</div>
<p>We can also take a look at the variance which measures the average amount of deviation from the mean value.
For a discrete <em>random variable</em> <span class="math notranslate nohighlight">\(X\)</span> this is defined via</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(X) = \frac{1}{n} \sum_{i=1}^{n} \left( x_i - \mu \right)^2 
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_1</span><span class="p">,</span> <span class="n">ax_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Variance of 3 and 8&quot;</span><span class="p">)</span>

<span class="n">ax_1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_3</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_8</span><span class="p">]</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/467c51afc516adf2cc3ed91fd49e1f9f26653179e77d39a0d7119f28f5926b71.svg" src="../_images/467c51afc516adf2cc3ed91fd49e1f9f26653179e77d39a0d7119f28f5926b71.svg" /></div>
</div>
<p>It is interesting to see that the variance at the center of <span class="math notranslate nohighlight">\(8\)</span> is quite low, which tells us that nearly all samples of our 8 go through the center.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Difference between mean of digits 3 and 8&quot;</span><span class="p">)</span>

<span class="n">mean_3</span> <span class="o">=</span> <span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mean_8</span> <span class="o">=</span> <span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_8</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">mean_3</span> <span class="o">-</span> <span class="n">mean_8</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;seismic&quot;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">150</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0c8c75e1a57ab3bb371454aa7a374c94f4e99733a18e9aae26f4acc6933b5e85.svg" src="../_images/0c8c75e1a57ab3bb371454aa7a374c94f4e99733a18e9aae26f4acc6933b5e85.svg" /></div>
</div>
</section>
<section id="what-to-derive-from-data-analysis">
<h2><span class="section-number">3.2. </span>What to derive from data analysis<a class="headerlink" href="#what-to-derive-from-data-analysis" title="Permalink to this heading">#</a></h2>
<p>This analysis can already help us to formulate a first, very naive model to guess if the shown sample is either a <span class="math notranslate nohighlight">\(3\)</span> or an <span class="math notranslate nohighlight">\(8\)</span>, based on a single pixel.
We start again by calculating the mean image for each class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_3</span> <span class="o">=</span> <span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">mean_8</span> <span class="o">=</span> <span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_8</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Now we will use this mean values to find the actual pixel which has the biggest absolute difference between both classes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pixel_differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mean_3</span> <span class="o">-</span> <span class="n">mean_8</span><span class="p">)</span>
<span class="n">idx_highest_pixel_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pixel_differences</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Pixel with highest difference is #</span><span class="si">{</span><span class="n">idx_highest_pixel_diff</span><span class="si">}</span><span class="s2"> with value </span><span class="si">{</span><span class="n">pixel_differences</span><span class="p">[</span><span class="n">idx_highest_pixel_diff</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pixel with highest difference is #488 with value 151.27191629148817
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>

<span class="n">best_pixel_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">idx_highest_pixel_diff</span><span class="p">,</span> <span class="n">image_shape</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_1</span><span class="p">,</span> <span class="n">ax_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Variance of 3 and 8&quot;</span><span class="p">)</span>

<span class="n">ax_1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mean_3</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image_shape</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">)</span>
<span class="n">ax_1</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">best_pixel_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">best_pixel_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">ax_2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mean_8</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">image_shape</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">best_pixel_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">best_pixel_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pixel for differentiating 3 and 8 at </span><span class="si">{</span><span class="n">best_pixel_coords</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3dec90dcbfb1a269ac65501a0ed6097db0814057a7ef60eca240b7f940682ace.svg" src="../_images/3dec90dcbfb1a269ac65501a0ed6097db0814057a7ef60eca240b7f940682ace.svg" /></div>
</div>
<p>By taking a look if this given pixel is closer to the corresponding value of the mean of <span class="math notranslate nohighlight">\(3\)</span> and <span class="math notranslate nohighlight">\(8\)</span>, we will decide accordingly.
We can do this by calculating the mean between both values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="p">(</span><span class="n">mean_3</span><span class="p">[</span><span class="n">idx_highest_pixel_diff</span><span class="p">]</span> <span class="o">+</span> <span class="n">mean_8</span><span class="p">[</span><span class="n">idx_highest_pixel_diff</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>


<span class="k">def</span> <span class="nf">is_it_3_or_8</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">pixel_index</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">sample</span><span class="p">[</span><span class="n">pixel_index</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span> <span class="k">else</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Prediction of 3 and 8 based on single pixel&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axs</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
    <span class="n">rand_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">idx_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">idx_8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()])</span>
    <span class="p">)</span>
    <span class="n">rand_im</span> <span class="o">=</span> <span class="n">mnist_data</span><span class="p">[</span><span class="n">rand_index</span><span class="p">]</span>
    <span class="n">predicted_number</span> <span class="o">=</span> <span class="n">is_it_3_or_8</span><span class="p">(</span>
        <span class="n">sample</span><span class="o">=</span><span class="n">rand_im</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">pixel_index</span><span class="o">=</span><span class="n">idx_highest_pixel_diff</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rand_im</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray_r&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pred </span><span class="si">{</span><span class="n">predicted_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8e8d88c6958bbb585f67cdf658a42f121f843bc326c084f813e95962356e5ff7.svg" src="../_images/8e8d88c6958bbb585f67cdf658a42f121f843bc326c084f813e95962356e5ff7.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_3</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">),</span>
        <span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_8</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">idx_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">idx_8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="n">idx_highest_pixel_diff</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span>

<span class="c1"># Calculate accuracy</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model accuracy: 0.83
</pre></div>
</div>
</div>
</div>
<p>An accuracy of around <span class="math notranslate nohighlight">\(86\%\)</span> is not great, but also not terrible, considering we’re only using a single pixel.
We’ve identified the two key parameters: the pixel and its threshold value, which help distinguish the classes.
However, remember that random guessing would give us <span class="math notranslate nohighlight">\(50\%\)</span> accuracy.</p>
<div class="admonition-task admonition">
<p class="admonition-title">Task</p>
<ul class="simple">
<li><p>Do this for another pair of numbers</p></li>
<li><p>How can we find the 2nd most significant pixel if we settled already for the first pixel?</p></li>
</ul>
</div>
</section>
<section id="mcculloch-and-pitts-model">
<h2><span class="section-number">3.3. </span>McCulloch and Pitts model<a class="headerlink" href="#mcculloch-and-pitts-model" title="Permalink to this heading">#</a></h2>
<p>In 1943 Warren McCulloch and Walter Pitts proposed a model of an artificial neuron <span id="id1">[<a class="reference internal" href="../bibliography.html#id3" title="Warren S. McCulloch and Walter Pitts. A logical calculus of the ideas immanent in nervous activity. The Bulletin of Mathematical Biophysics, 5(4):115-133, December 1943. URL: http://dx.doi.org/10.1007/bf02478259, doi:10.1007/bf02478259.">MP43</a>]</span>, called the McCulloch Pitts cell and acts very similar to our efforts by separating the values of <span class="math notranslate nohighlight">\(3\)</span> and <span class="math notranslate nohighlight">\(8\)</span> based on a single pixel.
It is one of the earliest models of a neuron in the field of machine learning, as it was designed to mimic the behavior of biological neurons in a simplified manner.</p>
<p>Mathematically, an <span class="math notranslate nohighlight">\(n\)</span>-dimensional neuron can be described via the summation of an <span class="math notranslate nohighlight">\(n\)</span> dimensional binary input vector <span class="math notranslate nohighlight">\(x\)</span>, which gets compared to a threshold <span class="math notranslate nohighlight">\(\Theta\)</span>, which can be written as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
y = f(x) = \begin{cases}
    1 &amp; \text{ if } ~ \sum_{i=1}^{n} x_i  \geq \Theta \\
    0 &amp; \text{else}
\end{cases}
\end{split}\]</div>
<figure class="align-default" id="id4">
<img alt="https://upload.wikimedia.org/wikipedia/commons/a/a7/Diagram_of_a_McCulloch-Pitts-cell.svg" src="https://upload.wikimedia.org/wikipedia/commons/a/a7/Diagram_of_a_McCulloch-Pitts-cell.svg" /><figcaption>
<p><span class="caption-number">Fig. 3.3 </span><span class="caption-text">A graphical representation of a McCulloch-Pitts cell with <span class="math notranslate nohighlight">\(n\)</span> inputs and <span class="math notranslate nohighlight">\(\Theta\)</span> as activation threshold. Source <a class="reference external" href="https://commons.wikimedia.org/wiki/File:Diagram_of_a_McCulloch-Pitts-cell.svg">https://commons.wikimedia.org/wiki/File:Diagram_of_a_McCulloch-Pitts-cell.svg</a>.</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition-task admonition">
<p class="admonition-title">Task</p>
<ul>
<li><p>Can you implement the following functions with said model?</p>
<ul class="simple">
<li><p>and</p></li>
<li><p>or</p></li>
<li><p>not</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Exclusive_or">xor</a></p></li>
</ul>
<p>If, what are the thresholds of the neuron?</p>
</li>
<li><p>Read <a class="reference external" href="https://towardsdatascience.com/mcculloch-pitts-model-5fdf65ac5dd1">https://towardsdatascience.com/mcculloch-pitts-model-5fdf65ac5dd1</a></p></li>
</ul>
</div>
<section id="perceptron">
<h3><span class="section-number">3.3.1. </span>Perceptron<a class="headerlink" href="#perceptron" title="Permalink to this heading">#</a></h3>
<p>In 1957, Frank Rosenblatt suggested an extension to the McCulloch pitts model called a <a class="reference external" href="https://en.wikipedia.org/wiki/Perceptron"><em>Perceptron</em></a>.
The model changes the <span class="math notranslate nohighlight">\(n\)</span>-dimensional binary input vector <span class="math notranslate nohighlight">\(x\)</span> to a real-valued input vector,
Additionally, each of the values <span class="math notranslate nohighlight">\(x_i\)</span> of this vector <span class="math notranslate nohighlight">\(x\)</span> as a <em>weight</em> <span class="math notranslate nohighlight">\(w_i\)</span> associated, which are collected in the vector <span class="math notranslate nohighlight">\(w\)</span>.
These <em>weights</em> act as a scaling for our input data and can be adjusted.</p>
<p>The perceptron can therefore be described via</p>
<div class="math notranslate nohighlight">
\[\begin{split}
y = f(x) = \begin{cases}
    1 &amp; \text{ if } ~ \sum_{i=1}^{n} w_i x_i  \geq \Theta \\
    0 &amp; \text{else}
\end{cases}
\end{split}\]</div>
<p>Instead of adjusting the weights manually we can describe an algorithm to approximate those weights.</p>
<p>We start by transforming the pixels of each square <span class="math notranslate nohighlight">\(28 \times 28\)</span> image into a <span class="math notranslate nohighlight">\(784\)</span> dimensional vector.
Additionally, we will create a vector <span class="math notranslate nohighlight">\(y\)</span> which maps <span class="math notranslate nohighlight">\(3\)</span> to <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(8\)</span> to <span class="math notranslate nohighlight">\(1\)</span> for each value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prepare dataset</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
    <span class="p">[</span><span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_3</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">),</span> <span class="n">mnist_data</span><span class="p">[</span><span class="n">idx_8</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">idx_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">idx_8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;X: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;y: </span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>X: (11982, 784)
y: (11982,)
</pre></div>
</div>
</div>
</div>
<p>As we transferred the images and the number it is representing into a vector, we can now take a look how to find some good weights, such that we can calculate what we did prior manually on a single pixel now for the whole image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># makes the outcome deterministic</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># create a random weight for each input vector</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># create a random threshold value to begin with - this is often also called a bias</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>

<span class="c1"># python implementation of the formula above</span>


<span class="k">def</span> <span class="nf">mc_culloch_pitts_neuron</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">theta</span> <span class="k">else</span> <span class="mi">0</span>


<span class="c1"># learning parameters</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1"># number of iterations through our dataset</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># the actual training loop</span>
<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
    <span class="c1"># we shuffle our dataset so we don&#39;t start by seeing all examples of a</span>
    <span class="c1"># 3 first and afterwards all 8s</span>
    <span class="n">random_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">random_indices</span><span class="p">)</span>

    <span class="c1"># now iterate over our dataset</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">random_indices</span><span class="p">:</span>
        <span class="c1"># calculate the current outcome</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="n">mc_culloch_pitts_neuron</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">weights</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

        <span class="c1"># calculate our error which is the difference between our outcome</span>
        <span class="c1"># and the actual value</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">prediction</span>

        <span class="c1"># we will try to adjust the weights by adjusting the weights</span>
        <span class="c1"># into the &quot;proper&quot; direction. We limit how much we can move into</span>
        <span class="c1"># this direction by the learning_rate</span>
        <span class="n">weights</span> <span class="o">+=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">error</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="c1"># we do the same for our threshold/theta/bias</span>
        <span class="n">theta</span> <span class="o">+=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">error</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mc_culloch_pitts_neuron</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">])</span>

<span class="c1"># calculate accuracy</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># visualize the weights</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">weights</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;seismic&quot;</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">150</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Weights Visualization&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model accuracy: 0.97
</pre></div>
</div>
<img alt="../_images/c068ba40c4ad3a31fc50fe7f0f810933ac9738fe7c03c3e3588513ed132d0d1c.svg" src="../_images/c068ba40c4ad3a31fc50fe7f0f810933ac9738fe7c03c3e3588513ed132d0d1c.svg" /></div>
</div>
<div class="admonition-task admonition">
<p class="admonition-title">Task</p>
<ul class="simple">
<li><p>Why is our model performing better than our previous model?</p></li>
<li><p>What represents blue, what red in the visualization?</p></li>
<li><p>Is it possible to implement the following functions?</p>
<ul>
<li><p>and</p></li>
<li><p>or</p></li>
<li><p>xor</p></li>
</ul>
</li>
<li><p>Try to implement this <em>training</em> algorithm in SuperCollider - first in sclang, afterwards on the server.</p></li>
<li><p>How could we leverage this model to predict not just binary classes but maybe all digits between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(9\)</span>?</p></li>
<li><p>Read <a class="reference external" href="https://www.oranlooney.com/post/adaptive-basis-functions/">https://www.oranlooney.com/post/adaptive-basis-functions/</a> as a primer on how to use taylor and fourier approximation</p></li>
</ul>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="02_artificial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>The artificial</p>
      </div>
    </a>
    <a class="right-next"
       href="04_measuring.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Measuring</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-data">3.1. Analyzing data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-to-derive-from-data-analysis">3.2. What to derive from data analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mcculloch-and-pitts-model">3.3. McCulloch and Pitts model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perceptron">3.3.1. Perceptron</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dennis Scheiba
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>